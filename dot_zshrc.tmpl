# Environment variables
{{ if eq .chezmoi.fqdnHostname "haseebs-macbook.lan" }}
export CURL_CA_BUNDLE="/Users/Shared/zscaler-cert.pem"
export NODE_EXTRA_CA_CERTS="/Users/Shared/zscaler-cert.pem"
export REQUESTS_CA_BUNDLE="/Users/Shared/python_cacert+zscaler.pem"
export SSL_CERT_FILE="/Users/Shared/zscaler-cert.pem"

export EDITOR="code --wait"
{{ else }}
export EDITOR="codium --wait"
{{ end -}}
export NVM_DIR="$HOME/.nvm"

# Aliases
if [ -f ~/.sh-aliases ]; then
    source ~/.sh-aliases
else
    echo "[WARN] bash aliases could not be loaded"
fi

# Autostart
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm

# AWSume: Auto-Complete function
autoload -Uz compinit && compinit
_awsume() {
    local state
    state=("${(@f)$(awsume-autocomplete)}")
    compadd -- $state
}
compdef _awsume awsume

# ??
if [ -f "$HOME/.local/bin/env" ]; then
    . "$HOME/.local/bin/env"
fi

# Dotnet Version Manager
{{ if eq .osid "darwin" }}
if [ -f "$HOME/Library/Application Support/dnvm/env" ]; then
    . "$HOME/Library/Application Support/dnvm/env"
else
    echo "[WARN] dnvm could not be loaded"
fi
{{ else if eq .osid "linux-manjaro" }}
if [ -f "$HOME/.local/share/dnvm/env" ]; then
    . "$HOME/.local/share/dnvm/env"
else
    echo "[WARN] dnvm could not be loaded"
fi
{{ end -}}

# Load Angular CLI autocompletion.
if eval "command -v ng >/dev/null 2>&1"; then
    source <(ng completion script)
fi

# Chromium
if eval "command -v chromium >/dev/null 2>&1"; then
    export CHROME_BIN=$(which chromium)
fi

# Bitwarden SSH Agent
{{- if eq .chezmoi.fqdnHostname "haseebs-macbook.lan" }}
BITWARDEN_SSH_AGENT="/Users/$USER/Library/Containers/com.bitwarden.desktop/Data/.bitwarden-ssh-agent.sock"
{{- else }}
BITWARDEN_SSH_AGENT="$HOME/.bitwarden-ssh-agent.sock"
{{- end }}

if [ -S "$BITWARDEN_SSH_AGENT" ]; then
    export SSH_AUTH_SOCK="$BITWARDEN_SSH_AGENT"
else
    echo "[WARN] bitwarden ssh agent could not be loaded"
fi

BITWARDEN_FLATPAK_SSH_AGENT="$HOME/.var/app/com.bitwarden.desktop/data/.bitwarden-ssh-agent.sock"
if [ -S "$BITWARDEN_FLATPAK_SSH_AGENT" ]; then
    export SSH_AUTH_SOCK="$BITWARDEN_FLATPAK_SSH_AGENT"
fi
